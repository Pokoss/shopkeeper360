import{r as l,W as R,j as e,y as i}from"./app-cYYah45n.js";import{L as P}from"./Layout-C17My6Ld.js";import{r as a}from"./index-DOnEnX8Z.js";import{l as L}from"./index-DK_-4NCe.js";import{X as p}from"./index.es-DeyPHitZ.js";import{Q as k,B as h}from"./react-toastify.esm-CpAWi2rw.js";/* empty css                      */const U=[{name:e.jsx("b",{children:"Item"}),selector:t=>t.product.name,wrap:!0},{name:e.jsx("b",{children:"Qty"}),selector:t=>t.quantity,grow:!0,width:"60px",right:!0},{name:e.jsx("b",{children:"Price"}),selector:t=>Intl.NumberFormat("en-US").format(t.order_price),grow:!0,width:"90px",right:!0}],T=l.forwardRef(({company:t,props:n})=>(console.log(n),R(),e.jsxs("div",{className:"text-sm text-uppercase monospace",children:[e.jsxs("div",{className:"w-full items-center justify-center space-x-5",children:[e.jsx("div",{className:"flex items-center justify-center w-full",children:e.jsx("img",{src:"/"+t.company.logo,alt:"facility logo",className:"h-20 object-contain rounded-lg mb-2"})}),e.jsxs("div",{className:"flex flex-col mb-4 items-center",children:[e.jsx("div",{className:"text-lg font-bold",children:t.company.name}),e.jsxs("div",{className:"my-1",children:["No. ",n.orders.order_id]}),e.jsx("div",{children:new Date(n.orders.created_at).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"numeric"})}),e.jsx("div",{className:"font-bold mt-1",children:"CUSTOMER ORDER"})]})]}),e.jsx(p,{columns:U,data:n.orders.items}),e.jsx("table",{className:"w-full mt-2 bg-transparent",children:e.jsx("tbody",{children:e.jsxs("tr",{children:[e.jsx("td",{className:"font-semibold text-start pl-5 py-2",children:"TOTAL"}),e.jsx("td",{className:"text-end pr-5",children:"UGX "+Intl.NumberFormat("en-US").format(n.orders.order_total)})]})})}),e.jsxs("div",{className:"flex justify-between mt-5",children:[e.jsx("div",{className:"text-start pl-5",children:"Customer"}),e.jsx("div",{className:"text-end pr-5",children:n.orders.user.name})]}),e.jsxs("div",{className:"flex flex-col mt-5 mb-4 items-center",children:[e.jsx("div",{children:"Thank you for supporting us!"}),e.jsx("div",{children:t.company.contacts}),e.jsx("div",{children:t.company.location})]})]})));function B({orders:t,company:n}){console.log(t);const g={headRow:{style:{border:"none"}},headCells:{style:{color:"#997400",fontSize:"14px"}},rows:{highlightOnHoverStyle:{backgroundColor:"rgb(230, 244, 244)",borderBottomColor:"#FFFFFF",outline:"1px solid #FFFFFF"}},pagination:{style:{border:"none"}}},j=[{name:"Order Number",selector:r=>r.order_id},{name:"Customer Name",selector:r=>r.user.name},{name:"Order Amount (UGX)",selector:r=>Intl.NumberFormat("en-US").format(r.order_total)},{name:"Order Status",selector:r=>r.status=="pending"?e.jsxs("div",{className:"bg-red-500 text-white p-2 rounded-lg",children:[r.status," "]}):e.jsx("div",{className:"bg-green-500 p-2 text-white rounded-lg",children:r.status})},{name:"Sold On",selector:r=>new Date(r.updated_at).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"numeric"})},{selector:r=>e.jsx("div",{className:"flex gap-4",children:e.jsx("button",{onClick:()=>w(r),className:"bg-green-600 rounded-md p-1",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"white",className:"w-5 h-5",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10"})})})})}],f=async r=>{if(r.preventDefault(),s.orders.status!="pending"){var o=s.orders.company_id,C=s.orders.order_total,D=s.orders.order_id,_=s.orders.user.id;i.post("/record_sale",{company_id:o,order_id:D,order_total:C,user_id:_},{onSuccess:()=>{h.success("Sale recorded successfully"),c()}})}else c(),h.error("Only pending orders can be recorded")},[d,v]=l.useState(null),c=r=>v(r),m=l.useRef(),b=L.useReactToPrint({content:()=>m.current}),[s,y]=l.useState(null);function w(r){c("xl");var o={orders:r};y(o),console.log(o)}const[E,u]=l.useState(t.current_page),N=r=>{i.get(`/dashboard/${n.company.slug}/online-portal/orders`,{page:r,search:x},{preserveState:!0})},S=r=>{u(r),N(r)},[x,O]=l.useState(""),F=r=>{r.preventDefault(),O(r.target.value),u(1);var o=r.target.value;i.get(`/dashboard/${n.company.slug}/online-portal/orders`,{search:o,page:1},{preserveState:!0,preserveScroll:!0,onSuccess:()=>{}})};return e.jsxs("div",{children:[e.jsx(p,{title:e.jsxs("div",{className:"flex flex-col md:flex-row space-x-0 md:space-x-5 space-y-5 md:space-y-0 whitespace-nowrap items-start md:items-center justify-between w-full border-b-2 border-primary pb-3 pt-2",children:[e.jsx("span",{children:"Online Orders"}),e.jsx("div",{className:"flex space-x-3 items-center md:space-x-5 w-full md:w-1/2 md:justify-end print:hidden",children:e.jsx(a.Input,{type:"text",label:"Search",value:x,onChange:F,className:"md:w-full"})})]}),columns:j,data:t.data,customStyles:g,pointerOnHover:!0,onRowClicked:(r,o)=>!children&&ExpandableComponent?null:editRow(r,o),highlightOnHover:!0,pagination:!0,paginationTotalRows:t.total,paginationPerPage:t.per_page,paginationServer:!0,onChangePage:S,paginationRowsPerPageOptions:[]}),e.jsx(l.Fragment,{children:e.jsxs(a.Dialog,{open:d==="xl",size:d,handler:c,children:[e.jsx(a.DialogHeader,{children:e.jsx(a.Typography,{variant:"h5",color:"blue-gray",children:"View Order"})}),e.jsx("form",{children:e.jsxs(a.DialogBody,{divider:!0,className:"h-[29rem] overflow-scroll",children:[s==null?e.jsx("div",{children:"No Orders"}):e.jsxs("div",{className:"font-bold",children:["Name: ",s.orders.user.name,e.jsx("br",{}),"Contact: ",s.orders.contact,e.jsx("br",{}),"Location Details: ",s.orders.location,e.jsx("br",{}),"Status: ",s.orders.status,e.jsx("br",{}),"Total: ","UGX "+Intl.NumberFormat("en-US").format(s.orders.order_total),e.jsx("br",{}),"Ordered On ",new Date(s.orders.created_at).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"numeric"}),e.jsx("br",{})]}),e.jsx("div",{ref:m,children:e.jsx(T,{company:n,props:s})})]})}),e.jsx(a.DialogFooter,{children:e.jsxs("div",{className:"flex w-full justify-between",children:[e.jsx("div",{children:e.jsxs("div",{className:"space-x-2 flex",children:[e.jsx(a.Button,{onClick:c,variant:"gradient",color:"red",children:"Close"}),e.jsx(a.Button,{onClick:b,type:"submit",className:"bg-green-500",children:"Print"})]})}),e.jsx(a.Button,{onClick:f,type:"submit",className:"bg-primary",children:"Record sale"})]})})]})}),e.jsx(k,{})]})}B.layout=t=>e.jsx(P,{children:t,props:t.props.company});export{B as default};
