import{r as o,j as r,a as _,y as i}from"./app-D2NLOtae.js";import{r as s}from"./index-C8m7lxvO.js";import{X as L}from"./index.es-Dw4fVMrN.js";import{Q as D,B as d}from"./react-toastify.esm-YHAwkjFx.js";/* empty css                      */import{L as P}from"./Layout-DNaUaIuD.js";function O({company:n,services:l}){function m(e){return e==null?void 0:e.reduce((a,t)=>a+parseFloat(t.product.retail_price)*parseFloat(t.quantity),0)}const y=[{name:"Service ID",selector:e=>e.service_id,sortable:!0},{name:"Name",selector:e=>e.name||"Unnamed Service",sortable:!0},{name:"Status",cell:e=>r.jsx("span",{className:`px-3 py-1 rounded-full text-white text-xs font-medium ${e.status==="pending"?"bg-red-500":"bg-green-600"}`,children:e.status})},{name:"Current Price (UGX)",selector:e=>m(e.service_items),format:e=>Intl.NumberFormat("en-US").format(m(e.service_items)),sortable:!0},{name:"Employee",selector:e=>{var a;return((a=e.employee)==null?void 0:a.name)||"â€”"}},{name:"Added On",selector:e=>new Date(e.created_at).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit"})},{name:"Action",cell:e=>r.jsx("button",{onClick:()=>i.visit(`/dashboard/${n.company.slug}/service/panel/${e.service_id}`),className:"p-2 bg-green-600 rounded hover:bg-green-700",children:r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"white",className:"w-4 h-4",children:[r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Z"}),r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10"})]})}),ignoreRowClick:!0,allowOverflow:!0,button:!0}],S={headRow:{style:{backgroundColor:"#f8fafc"}},headCells:{style:{fontWeight:"bold",fontSize:"13px",textTransform:"uppercase",color:"#4CAF50"}},rows:{style:{minHeight:"50px"},highlightOnHoverStyle:{backgroundColor:"#f1f5f9",cursor:"pointer"}}},[p,j]=o.useState(null),c=e=>j(e),[h,g]=o.useState(""),[u,x]=o.useState(!1),b=async e=>{e.preventDefault();const a=n.company_id;if(!u){x(!0);try{i.post("/add-running-service",{companyId:a,service:h},{onSuccess:async()=>{d.success("Service added successfully"),g(""),x(!1);try{const t=await axios.get(`/service_id?company_id=${a}`);t.data.service_id&&i.visit(`/dashboard/${n.company.slug}/service/panel/${t.data.service_id}`)}catch(t){console.error("Error fetching new service ID:",t)}c()},onError:t=>d.error(t)})}catch(t){d.dismiss(),d.error(t)}}},[v,w]=o.useState(""),N=e=>{const a=e.target.value;w(a),f(1),i.get(`/dashboard/${n.company.slug}/service/panel`,{search:a,page:1},{preserveState:!0,preserveScroll:!0})},[$,f]=o.useState(l.current_page),C=e=>{i.get(`/dashboard/${n.company.slug}/service/panel`,{page:e,search:v},{preserveState:!0})},k=e=>{f(e),C(e)};return r.jsxs("div",{children:[r.jsx(_,{children:r.jsx("title",{children:"Running Services"})}),r.jsxs(s.Dialog,{open:p==="xl",size:p,handler:c,children:[r.jsx(s.DialogHeader,{children:r.jsx(s.Typography,{variant:"h5",color:"blue-gray",children:"Add a Service"})}),r.jsxs("form",{onSubmit:b,children:[r.jsxs(s.DialogBody,{divider:!0,className:"h-[28rem] overflow-y-auto px-6 py-4",children:[r.jsx("div",{className:"w-full space-y-4",children:r.jsx(s.Input,{label:"Name (Optional)",value:h,onChange:e=>g(e.target.value),size:"lg"})}),r.jsx(D,{})]}),r.jsxs(s.DialogFooter,{className:"space-x-2",children:[r.jsx(s.Button,{onClick:c,variant:"gradient",color:"blue-gray",children:"Close"}),r.jsxs(s.Button,{type:"submit",disabled:u,className:"bg-primary",children:[" ",u?r.jsx(s.Spinner,{size:"sm"}):"Create New Service"]})]})]})]}),r.jsx(L,{title:r.jsxs("div",{className:"p-2 flex flex-col md:flex-row items-start md:items-center justify-between border-b border-primary pb-3",children:[r.jsx("span",{className:"text-lg font-medium",children:"Running Services"}),r.jsxs("div",{className:"flex items-center space-x-2 mt-2 md:mt-0 w-full md:w-1/2",children:[r.jsx(s.Input,{type:"text",label:"Search",value:v,onChange:N}),r.jsxs(s.Button,{onClick:()=>c("xl"),className:" bg-gradient-to-r from-primary to-secondary text-white flex items-center gap-2 h-10",children:[r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-5 h-5",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.5v15m7.5-7.5h-15"})}),"Service"]})]})]}),columns:y,data:l.data,customStyles:S,pointerOnHover:!0,highlightOnHover:!0,pagination:!0,paginationServer:!0,paginationTotalRows:l.total,paginationPerPage:l.per_page,onChangePage:k,paginationRowsPerPageOptions:[],noDataComponent:r.jsx("div",{className:"text-gray-400 py-4",children:"No services available"})})]})}O.layout=n=>r.jsx(P,{children:n,props:n.props.company});export{O as default};
